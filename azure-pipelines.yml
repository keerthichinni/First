# Azure Pipeline for a Python Application
trigger:
  branches:
    include:
      - main  # Trigger pipeline on changes to the main branch

pool:
  vmImage: 'ubuntu-latest'  # Use Ubuntu as the build agent

stages:
- stage: Build
  jobs:
  - job: BuildJob
    displayName: 'Build the Python Application'
    steps:
    - task: UsePythonVersion@0
      inputs:
        versionSpec: '3.x'
        addToPath: true

    - script: |
        python -m venv venv
        source venv/bin/activate
        pip install -r requirements.txt
      displayName: 'Setup Python Environment and Install Dependencies'

- stage: Test
  jobs:
  - job: TestJob
    displayName: 'Run Python Tests'
    steps:
    - script: |
        source venv/bin/activate
        pytest
      displayName: 'Run Unit Tests'

- stage: Deploy
  jobs:
  - job: DeployJob
    displayName: 'Deploy the Application'
    steps:
    - script: |
        echo "Deploying the Python application..."
      displayName: 'Deploy Simulation'